# RandomUser Django App

## Описание проекта

Приложение для загрузки, хранения и отображения пользователей, полученных из внешнего API https://randomuser.me/. Позволяет загрузить указанное количество пользователей в базу данных, просмотреть их в виде таблицы с пагинацией, перейти на страницу с детальной информацией по каждому пользователю, получить случайного пользователя из базы данных.

## Используемые технологии

- Python
- Django 5.2  
- PostgreSQL
- Docker и Docker Compose (для контейнеризации)  
- Requests (для работы с внешним API)  
- HTML, CSS  

## Обоснование выбора технологий

**Веб-фреймворк Django:**  
Django — это веб-фреймворк на Python, предоставляющий готовые решения для многих типичных задач веб-разработки: ORM, маршрутизацию, шаблонизатор, административную панель и инструменты для работы с формами и тестированием. Это значительно ускоряет разработку и упрощает поддержку проекта, поэтому django хорошо подойдет для этого задания.
**База данных PostgreSQL:**  
PostgreSQL — это надежная и функциональная реляционная база данных с богатым функционалом, поддержкой сложных запросов и транзакций. В рамках задания, где требуется хранить большое количество записей о пользователях и делать выборки с пагинацией, PostgreSQL обеспечивает отличную производительность и масштабируемость. Кроме того, Django имеет отличную встроенную поддержку PostgreSQL, что упрощает интеграцию.

## Инструкция по запуску

### Вариант 1: Запуск с Docker и Docker Compose (предпочтительно)

### Требования

- Docker, Docker Desktop

### Запуск

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/KlyushovaPolina/randomuser_project
   cd randomuser_project
   ```

2. **Проверьте, что Docker запущен**:
   - Убедитесь, что Docker и Docker Compose установлены и работают. Для Windows/macOS запустите Docker Desktop.


3. **Соберите и запустите контейнеры**:
   ```bash
   docker-compose up --build
   ```
   - Эта команда собирает приложение и запускает контейнеры для Django и PostgreSQL.
   - Веб-приложение будет доступно по адресу: `http://localhost:8000/`.
   - Контейнер PostgreSQL автоматически создается и настраивается для приложения.
   - Автоматически выполняются миграции, создается 1000 пользователей, создается админ для входа в админ-панель

### Вариант 2: Запуск без Docker

### Требования
- **Python**: Версия 3.8 или выше.
- **База данных**: PostgreSQL (версия 17.5).

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/KlyushovaPolina/randomuser_project
   cd randomuser_project
   ```

2. **Создайте и активируйте виртуальное окружение**:
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # Linux/macOS
   venv\Scripts\activate     # Windows
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте подключение к базе данных**:
   - Настройте PostgreSQL и укажите параметры подключения в файле `settings.py` (например, `DATABASE_URL` или поля `NAME`, `USER`, `PASSWORD`, `HOST`, `PORT`).

5. **Примените миграции**:
   ```bash
   python manage.py migrate
   ```

6. **Загрузите начальные данные**:
   - Выполните команду для загрузки 1000 пользователей из API RandomUser.me:
     ```bash
     python manage.py fetch_users
     ```
   - Создайте администратора (если требуется):
     ```bash
     python manage.py createsuperuser
     ```

7. **Запустите сервер**:
   ```bash
   python manage.py runserver
   ```
   - Приложение будет доступно по адресу: `http://localhost:8000/`.


## Доступные API-эндпоинты

В файле `urls.py` определены следующие маршруты:

| Путь            | Метод      | Описание                                                                 | Пример URL                     |
|-----------------|------------|--------------------------------------------------------------------------|--------------------------------|
| `/`             | GET, POST  | Главная страница с формой для загрузки пользователей из API и таблицей всех пользователей с пагинацией. POST-запрос загружает указанное количество пользователей из внешнего API и сохраняет их в базу данных. | `http://localhost:8000/`       |
| `/random/`      | GET        | Возвращает данные случайного пользователя из базы данных в формате HTML.  | `http://localhost:8000/random/` |
| `/<int:user_id>/` | GET        | Отображает детальную информацию о пользователе с заданным ID в формате HTML. | `http://localhost:8000/5/`     |


## Админ-панель

- Админ-панель Django доступна по адресу: `http://localhost:8000/admin/`.
- Для доступа используйте учетные данные администратора, созданные с помощью команды:
  ```bash
  python manage.py create_admin
  ```
- В админ-панели можно просматривать, редактировать и удалять записи о пользователях, а также управлять другими данными приложения.

## Тестирование

### Написанные тесты
- Покрыта основная функциональность:
  - Загрузка пользователей из API.
  - Отображение главной страницы, страницы случайного пользователя и страницы с деталями пользователя.
- Все запросы к внешнему API (`randomuser.me`) замоканы с использованием библиотеки `responses`, чтобы тесты не зависели от реальных сетевых запросов.

### Запуск тестов
Чтобы запустить тесты, выполните:
```bash
docker-compose exec web python manage.py test
```